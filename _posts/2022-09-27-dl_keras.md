---
title: "[DL/PRJ] Keras ì´ìš©í•´ì„œ DL ëª¨ë¸ ë§Œë“¤ê¸°"
excerpt: "ëŒ€í•™ì› í•©ê²© ì˜ˆì¸¡ ë”¥ëŸ¬ë‹ ëª¨ë¸"
categories:
  - DeepLearning
  - Project
tags:
  - tensorflow
  - coding apple
last_modified_at: 2022-09-27
---

> `Keras`ë¥¼ ì´ìš©í•˜ë©´ ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ ì†ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

<div class="notice--info" markdown="1">
ğŸ’¡ (ìš”ì•½) ë”¥ëŸ¬ë‹ ëª¨ë¸ ë§Œë“¤ê¸° <br>
1. ë°ì´í„° ì „ì²˜ë¦¬ <br>
2. ëª¨ë¸ ë¹Œë”© & í•™ìŠµ <br>
3. ìƒˆë¡œìš´ ë°ì´í„° ì˜ˆì¸¡ <br>
</div>

<div class="notice--info" markdown="1">
ğŸ’¡ (ì°¸ê³ ) ë”¥ëŸ¬ë‹ ëª¨ë¸ ì„±ëŠ¥ í–¥ìƒ <br>
1. ë°ì´í„° ì „ì²˜ë¦¬ <br>
2. íŒŒë¼ë¯¸í„° íŠœë‹ (layer ê°¯ìˆ˜, node ê°¯ìˆ˜, activation í•¨ìˆ˜ ë“±) <br>
3. ë°ì´í„° ì–‘ ëŠ˜ë¦¬ê¸° <br>
</div>

<br>

| ëŒ€í•™ì› í•©ê²© ì˜ˆì¸¡ í”„ë¡œì íŠ¸

# Code
```python
import pandas as pd
import tensorflow as tf


# Pre-process
data = pd.read_csv('gpascore.csv')
data = data.dropna()
y = data['admit'].values

x = []
for i, rows in data.iterrows():
    x.append([rows['gre'], rows['gpa'], rows['rank']])

# Model
model = tf.keras.models.Sequential([
    tf.keras.layers.Dense(64, activation='tanh'),
    tf.keras.layers.Dense(128, activation='tanh'),
    tf.keras.layers.Dense(1, activation='sigmoid')
])

# Train
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
model.fit(np.array(x), y, epochs=1000)

# Predict
pred = model.predict( [ [800, 4.20, 1], [300, 1.2, 2] ] )
```

<br>

# 1. Dataset

+ column: 4 (admit, gre, gpa, rank)
+ row: 427
+ admit=0(ë¶ˆí•©ê²©) / admit=1(í•©ê²©)

(table) Dataset example

| admit | gre | gpa  | rank |
|:-----:|:---:|:----:|:----:|
|   0   | 380 | 3.21 |  3   |
|   1   | 660 | 3.67 |  3   |
|   1   | 800 |  4   |  1   |
|  ...  | ... | ...  | ...  |

<br>

# 2. Data Preprocessing

## 1) Null value
```python
import pandas as pd

data = pd.read_csv('gpascore.csv')

# check null value
print(data.isnull().sum())

----------------------------------------
admit    0
gre      1
gpa      0
rank     0
dtype: int64
```

```python
# drop null-included rows
data = data.dropna()

print(data.isnull().sum())

----------------------------------------
admit    0
gre      0
gpa      0
rank     0
dtype: int64
```

## 2) X, Y data
```python
y = data['admit'].values
print(y)
print(type(y))

----------------------------------------
[0 1 1 1 0 1 1 ...1 1]
<class 'numpy.ndarray'>
```

```python
x = []

for i, rows in data.iterrows():
    x.append([rows['gre'], rows['gpa'], rows['rank']])

print(x)
print(type(x))

----------------------------------------
[[380.0, 3.21, 3.0], [660.0, 3.67, 3.0], ..., [760.0, 3.76, 2.0], [710.0, 3.82, 3.0]]
<class 'list'>
```

<br>

# 3. Build model & train

```python
import tensorflow as tf

# 1. model
model = tf.keras.models.Sequential([
    tf.keras.layers.Dense(64, activation='tanh'),
    tf.keras.layers.Dense(128, activation='tanh'),
    tf.keras.layers.Dense(1, activation='sigmoid')
])

# 2. model compile
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# 3. model training (weights updating)
model.fit(np.array(x), y, epochs=1000)

----------------------------------------
Epoch 1/1000
 9/14 [==================>...........] - ETA: 0s - loss: 0.7727 - accuracy: 0.4792
...
Epoch 999/1000
14/14 [==============================] - 0s 7ms/step - loss: 0.5708 - accuracy: 0.6965
Epoch 1000/1000
14/14 [==============================] - 0s 6ms/step - loss: 0.5710 - accuracy: 0.7082
<keras.callbacks.History at 0x17aab7280>
```
+ `model.fit`ì— x, y ë°ì´í„°ë¥¼ ë„£ì„ ë•Œ list í˜•íƒœê°€ ì•„ë‹Œ numpy array ë˜ëŠ” tf.tensor ìë£Œí˜•ìœ¼ë¡œ ë³€í™˜í•´ì„œ ë„£ì–´ì•¼í•œë‹¤. list í˜•íƒœë¡œ ë„£ìœ¼ë©´ ì—ëŸ¬ê°€ ëœ¬ë‹¤.
    + `np.array(ë°ì´í„°)` : list to array ë³€í™˜ í•¨ìˆ˜
+ y ë°ì´í„°ê°€ 0ê³¼ 1ë¡œ ë˜ì–´ìˆìœ¼ë¯€ë¡œ, ì†ì‹¤í•¨ìˆ˜ë¡œ `binary_crossentropy`ë¥¼ ì‚¬ìš©í•˜ê³ , ë§ˆì§€ë§‰ ë ˆì´ì–´ì—ëŠ” `sigmoid` í™œì„±í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.

<br>

# 4. Predict

```python
pred = model.predict( [ [800, 4.20, 1], [300, 1.2, 2] ] )
print(pred)

----------------------------------------
1/1 [==============================] - 0s 20ms/step
[[0.77883834]
 [0.00869057]]
```


<br>

# Reference
+ [ì½”ë”©ì• í”Œ - ë¬¸ê³¼ì—¬ë„ ìƒê´€ì—†ë‹¤ Tensorflow ë”¥ëŸ¬ë‹ AI ê¸°ì´ˆë¶€í„° ì‹¤ë¬´ê¹Œì§€](https://codingapple.com/course/python-deep-learning/)